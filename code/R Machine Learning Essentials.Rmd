```{r}
data("Titanic")
library(data.table)
# transforming from class table to dataframe
dtTitanic = data.table(Titanic)
colnames(dtTitanic)[5] = "Freq"



#impact of one feature


# a super useful way to summarize the dataframe
# no need to use table()
dtClass <- dtTitanic[, list(n=sum(Freq)), by=c('Survived',
'Class')]
dtClass[, percentage := n / sum(n), by='Class']
dtClass[, textPercentage := paste(round(percentage * 100), '%',
sep='')]
barplot(
height=dtClass[Survived == 'Yes', percentage],
names.arg=dtClass[Survived == 'Yes', Class],
# col=dtClass[Survived == 'Yes', Class],
ylim=c(0, 1),
legend.text=dtClass[Survived == 'Yes', textPercentage],
ylab='survival rate',
main='Survival rate by class'
)


#the impact of two features combined
dtGenderFreq <- dtTitanic[, list(n=sum(Freq)), by=c('Sex', 'Class')]
dtGenderFreq[, percentage := n / sum(n), by='Class']
dtGenderFreq <- dtGenderFreq[Sex == 'Female']
dtGenderFreq[, textPercentage := paste(round(percentage * 100), '%',
sep='')]
barplot(
height=dtGenderFreq[, percentage],
names.arg=dtGenderFreq[, Class],
# col=dtGenderFreq[, Class],
ylim=c(0, 1),
legend.text=dtGenderFreq[, textPercentage],
ylab='survival rate',
main='Percentage of females'
)
```

